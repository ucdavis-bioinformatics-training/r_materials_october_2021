---
title: "Data frames"
author: "UC Davis Bioinformatics Core"
date: "10/21/2021"
output: html_document
---

# Data frames

## Structure of a data frame

What is the birthweight object? In the enviroment browser, you should see that it is "42 obs. of 18 variables." It's probably a data table with 42 rows and 18 coumns. We can verfiy this using the `class()` and `dim()` functions.

```{r}
class(birthweight)
dim(birthweight)
```

A data frame organizes data into rows and columns. The object must be "rectangular," with all rows having the same number of fields, and all values in a column must be of the same type.

Each column of a data frame is a *vector*. A vector is an ordered collection of values of the same type.

Let's take a look at the contents.

```{r}
birthweight
```

The data frame format should look familiar. It's a lot like a spreadsheet.

Generally, we don't want to operate on the entire data frame. For example, to calculate the mean birth weight, we don't need the information in the "paternal.education" column.

There are three ways to subset data: \$, [[, and [.

## Selecting a single column using the \$ and [[ operators

The simplest way to get all the values in the "birthweight" column is with the \$ operator.

```{r}
birthweight$birthweight
mean(birthweight$birthweight)
```

This \$ operator is a shortcut for the [[ sub-setting operator, which requires typing six characters (two pairs of square brackets and a pair of quotation marks). They function in the same way, returning the *value* of the element named.

```{r}
birthweight[["birthweight"]]
mean(birthweight[["birthweight"]])
```

One difference to note is that while [[ works with the *index*, or column number, \$ does not.

```{r}
# which column contains the birthweight?
# lines beginning with a '#' are comments, and are not executed by R
colnames(birthweight)
birthweight[[5]]
mean(birthweight[[5]])
# un-comment the following line and see what happens:
#birthweight$5
```

## Selecting a subset of the data frame using the [ operator

Unlike \$ and [[, which return the value(s) contained in the specified element, [ returns an object of the same type it is used to subset. Using [ to retrieve the fifth column will return a data frame with 42 rows and 1 column. This may not seem like a big difference, but it can be an important distinction in some cases.

```{r}
birthweight[5]
```

Because the [ operator returns a new data frame, it can be used to specify multiple rows and / or columns.

```{r}
birthweight[c(1,5)]
```

The `c()` function creates a vector. This allows R to treat indices 1 and 5 as a single argument. This is critical, because `birthweight[1,5]` does not produce the same effect at all.

```{r}
birthweight[1, 5]
```

What happened?

When there are two arguments provided to [, R interprets these as the index on the first (row) and second (column) dimension of the object. The value returned is the content of the first row, fifth column: the birth weight of individual 1107.

```{r}
birthweight[c(2,7,29), c(1,5)]
```

R will also accept row or column names, and the use of the minus sign to exclude indices.

```{r}
colnames(birthweight)
birthweight[c("maternal.cigarettes", "birthweight")]
birthweight[c(1,3,5:13), -c(13:16)]
```

Finally, vectors of logical (TRUE/FALSE) values can be used to subset data. Rows or columns corresponding to "TRUE" elements will be returned, while rows or columns corresponding to "FALSE" elements will be excluded.

```{r}
birthweight[c(1,3,5:13), c(TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE, TRUE)]
```

This is much more useful than it may sound.

```{r}
birthweight$length
birthweight$length < 50
birthweight[birthweight$length < 50, c(1,4:12,17,18)]
```

### Subsetting a vector

A vector, like a column of a data frame, can be subsetted using the [ operator with an index or another vector.

```{r}
birthweight$length[1]
birthweight$length[c(1,2)]
```

Take a few minutes to explore subsetting.

